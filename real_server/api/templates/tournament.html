<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Torneo</title>
    <style>
        body {
            margin: 0; padding: 20px;
            font-family: Arial, sans-serif;
            background-color: #1A3636;
            color: #D6BD98;
        }
        canvas {
            background-color: #40534C;
            border: 2px solid #667D6A;
            display: block;
            margin: 20px auto;
        }
        .controlPause {
            position: absolute;
            top: 20px; right: 20px;
            z-index: 1000;
        }
        .controlHome {
            position: absolute;
            top: 20px; left: 20px;
            z-index: 1000;
        }
        #log {
            background: #667D6A;
            padding: 10px;
            height: 300px; width: 500px;
            overflow-y: scroll;
            font-family: monospace;
            margin-top: 10px;
            margin: 10px auto;
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas" width="800" height="600"></canvas>

    <div class="controlPause">
        <button id="pauseButton">Pausar</button>
    </div>
    <div class="controlHome">
        <button id="goHome">Go Home</button>
    </div>
    <div id="log"></div>

    <input type="hidden" id="tournamentId" value="1"> <!-- ID del torneo temporal -->
    <script src="../static/tournament.js"></script>
    <script>
        // Supongamos que tenemos un tournament_id en algún lugar
        //const tournament_id = 1; // Este valor debería ser dinámico en un caso real

        // Al cargar la página, obtenemos los jugadores desde el backend
        async function getPlayers() {
            try {
                const response = await fetch(`/user-profiles/`);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const players = await response.json();
                //log(`Jugadores obtenidos: ${JSON.stringify(players)}`);
                if (players && players.length > 0) {
                    startTournament(players);
                } else {
                    log("No se han encontrado jugadores.");
                }
            } catch (error) {
                log(`Error al cargar los jugadores: ${error.message}`);
            }
        }

        // Inicia el torneo con los jugadores obtenidos desde la base de datos
        function startTournament(players) {
            const tournament = new Tournament(players);
            let currentMatch = tournament.getCurrentMatch();
            log("Inicio del torneo");
            log("Jugadores: " + players);
            log(`Primer partido: ${currentMatch.player1} vs ${currentMatch.player2}\n`);
            gameLoop();
        }

        // Llamamos a la función para cargar los jugadores al cargar la página
        getPlayers();
    </script>
</body>
</html>

